from django.shortcuts import render
from django.http import Http404, JsonResponse
from .models import VulnerabilityAssessmentTool

# constant variables
from yellow_hat.constants import (
    NMAP,
    NMAP_SCAN_TYPES,
)


# Create your views here.
def index(request):
    return render(request, "vulnerability_assessment/index.html")


def vulnerability_assessment_tools(request, vulnerability_assessment_tool_slug):
    vulnerability_tool = VulnerabilityAssessmentTool.objects.get(
        slug=vulnerability_assessment_tool_slug
    )
    vulnerability_tool_name = vulnerability_tool.name.strip().lower()
    target_domain = ""

    try:
        if request.method == "GET":
            if vulnerability_tool_name in NMAP:
                return render(
                    request,
                    "vulnerability_assessment/nmap.html",
                    {
                        "vulnerability_tool": vulnerability_tool,
                        "nmap_scan_types": NMAP_SCAN_TYPES,
                    },
                )
        elif request.method == "POST":
            pass
    except VulnerabilityAssessmentTool.DoesNotExist:
        raise Http404("Vulnerability Assessment Tool does not exist")
